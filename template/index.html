<html>
	<head>
		<link rel="stylesheet" href="css/jquery-ui.css">
		<link rel="stylesheet" href="css/bootstrap.min.css">
		<link rel="stylesheet" href="css/style.css">
		<script type="text/javascript" src="result.js"></script>
		<script src="scripts/lib/jquery-1.12.4.js"></script>
		<script src="scripts/lib/jquery-ui.js"></script>
		<script src="scripts/lib/charts.js"></script>
		<script src="scripts/lib/vue.js"></script>
		<script type="text/javascript" src="scripts/utils.js"></script>
		<script type="text/javascript" src="scripts/table-data-formating.js"></script>
		<script>
		$(document).ready(function() {
			var app = new Vue({
				el: '#vue-app',
				data: {
					currentAuthor : getQueryVariable('author'),
					result : resultJson
				},
				methods: {
				getMethodIdentifier: function (line) {
					return line.methodInfo == null ? '' : line.methodInfo.methodUID
				},
				getMethodOwnerName: function (line) {
					return line.methodInfo == null ? '' : 'method owner : '+line.methodInfo.owner.name
				},
				getAuthorUrlQuery : function (author) {
					return "?author=" + author
				},
				getAuthorTabLink : function (author) {
					return "#" + getLegalClassName(author);
				},
				getAuthorContributionCanvasID : function (author) {
					return getLegalClassName(author) + "-progress-canvas";
				},
				getLegalClassName : function (author) {
					return getLegalClassName(author);
				},
				containAuthorLine : function(file, authorName){
					for (i=0; i<file.lines.length;i++){
						if (file.lines[i].author.name == authorName){
							return true;
						}
					}
					return false;
				},
				shouldDisplayLine : function(line, authorName){
					if (authorName == null || line.author.name == authorName || (line.methodInfo != null && line.methodInfo.owner.name == authorName)){
						return true;
					}
					return false;
				}
				}
			});
			$( "#code-style-app" ).accordion({
				collapsible: true,
				heightStyle: "content"
			});
			$( ".author-name-menu" ).menu({
				items: "> :not(.ui-widget-header)"
			});
			$( ".tabs" ).tabs();
		});
		</script>
		<script type="text/javascript" src="scripts/codeEffects.js"></script>
	</head>
	<body>
		<div id="vue-app">
			<div class="author-name-menu-container">
				<ul class="author-name-menu">
					<li class="ui-widget-header"><div>Authors</div></li>
					<li><a href="?">All</a></li>
					<li v-for="(k,author) in result.commits[0].authorContributionMap">
						<a v-bind:href="getAuthorUrlQuery(author)">{{ author }}</a>
					</li>
				</ul>
			</div>
			<div class="content-container">
				<div class="tabs">
					<ul>
						<li v-for="(k,author) in result.commits[0].authorContributionMap">
							<a v-if="currentAuthor==null || currentAuthor == author" v-bind:href="getAuthorTabLink(author)">{{ author}} </a>
						</li>
					</ul>
					<template v-for="(k,author) in result.commits[0].authorContributionMap">
					<div v-if="getCurrentAuthor()==null || currentAuthor == author" v-bind:id="getLegalClassName(author)">
						<div style="width: 90%;">
							<canvas v-bind:id="getAuthorContributionCanvasID(author)"></canvas>
						</div>
					</div>
					</template>
				</div>
				<div id="code-style-app" >
					<template v-for="file in result.commits[result.commits.length-1].fileinfos">
						<template v-if="containAuthorLine(file, currentAuthor) || currentAuthor == null">
							<h3>{{ file.path }}</h3>
							<div>
								<template v-for="line in file.lines">
									<template v-if="shouldDisplayLine(line, currentAuthor)">
										<div class="row">
											<div class="col-md-1 author-col">{{ line.author.name }}</div>
											<div class="col-md-3 issue-col">
												<span v-if="line.issues.length==0"> &nbsp; </span>
												<ul v-for="issue in line.issues">
													<li>{{issue.message}}</li>
												</ul>
											</div>
											<div class="col-md-1 line-number" >{{ line.lineNumber }}</div>
											<div class="col-md-7 line-content " v-bind:id="getMethodIdentifier(line)" v-bind:title="getMethodOwnerName(line)" ><pre>{{line.content}}</pre></div>
										</div>
									</template>
								</template>
							</div>
						</template>
					</template>
				</div>
			</div>
		</div>
	</body>
</html>